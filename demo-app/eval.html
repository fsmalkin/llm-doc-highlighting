<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LLM Doc Highlighting - Eval Review</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="./eval.css" />
  </head>
  <body>
    <div class="wrap eval-wrap">
      <aside class="panel">
        <div class="panel-header">
          <div class="kicker">Evaluation</div>
          <h1>Eval Review</h1>
          <p class="muted">
            Review the selected run, pick a document, and inspect a data point. The viewer shows ground truth
            vs A/B method boxes.
          </p>
          <div class="review-summary">
            <span id="docReviewStatus" class="badge">-</span>
            <span id="docReviewCounts" class="muted">-</span>
          </div>
          <a class="link" href="/demo.html">Back to demo</a>
          <a class="link" href="/">Back to landing</a>
        </div>

        <div class="section-panel alignment-panel">
          <div class="label">A/B alignment</div>
          <div class="ab-inline">
            <span id="abStatusChip" class="badge">-</span>
            <span id="abStatusNote" class="muted">Select a data point to see alignment.</span>
          </div>
        </div>

        <section class="section-panel">
          <div class="field-hero">
            <div>
              <div class="label">Field label</div>
              <div id="evalFieldLabel" class="answer">-</div>
            </div>
            <div class="field-actions">
              <button id="gtApplyBtn" class="primary" type="button">Accept GT</button>
              <span id="gtDirtyChip" class="badge info">Unsaved changes</span>
            </div>
          </div>
          <div class="panel-title">
            <div>
              <div class="label">Values</div>
              <div class="muted">Toggle visibility and select GT.</div>
            </div>
          </div>
          <div class="value-table">
            <div class="value-row header">
              <div>Source</div>
              <div>Show</div>
              <div>Use as GT</div>
              <div>Value</div>
            </div>
            <div class="value-row">
              <div class="source">Dataset (FUNSD)</div>
              <div class="toggle-cell">
                <label class="switch">
                  <input id="showGt" type="checkbox" checked />
                  <span class="slider"></span>
                </label>
              </div>
              <div class="pick-cell">
                <label class="gt-pick" title="Use dataset GT">
                  <input type="radio" name="gtPick" value="dataset" />
                  <span class="gt-pick-dot" aria-label="Use dataset GT"></span>
                </label>
                <span id="gtStatusChip" class="badge">-</span>
              </div>
              <button id="evalExpectedValue" class="answer answer-link" type="button" data-focus="gt">-</button>
            </div>
            <div class="value-row">
              <div class="source">Raw + Fuzzy</div>
              <div class="toggle-cell">
                <label class="switch">
                  <input id="showRaw" type="checkbox" checked />
                  <span class="slider"></span>
                </label>
              </div>
              <div class="pick-cell">
                <label class="gt-pick" title="Use Raw + Fuzzy as GT">
                  <input type="radio" name="gtPick" value="raw" />
                  <span class="gt-pick-dot" aria-label="Use Raw + Fuzzy as GT"></span>
                </label>
              </div>
              <button id="evalAnswerRaw" class="answer answer-link" type="button" data-focus="raw">-</button>
            </div>
            <div class="value-row">
              <div class="source">Indexed</div>
              <div class="toggle-cell">
                <label class="switch">
                  <input id="showIndexed" type="checkbox" />
                  <span class="slider"></span>
                </label>
              </div>
              <div class="pick-cell">
                <label class="gt-pick" title="Use Indexed as GT">
                  <input type="radio" name="gtPick" value="indexed" />
                  <span class="gt-pick-dot" aria-label="Use Indexed as GT"></span>
                </label>
              </div>
              <button id="evalAnswerIndexed" class="answer answer-link" type="button" data-focus="indexed">-</button>
            </div>
          </div>
          <div class="decision-strip">
            <label class="checkbox">
              <input id="gtExclude" type="checkbox" />
              Both wrong (exclude)
            </label>
          </div>
          <div class="note compact">
            <div class="note-row">
              <div class="label">Decision note (optional)</div>
              <button id="toggleGtNote" type="button" class="ghost">Add note</button>
            </div>
            <div id="gtNoteWrap" class="note-wrap collapsed">
              <textarea id="gtNote" rows="2" placeholder="Why this decision?"></textarea>
            </div>
          </div>
          <div class="overlay-tools">
            <div class="overlay-row">
              <span class="muted">A/B overlay (joint)</span>
              <label class="switch" title="Indeterminate means only A or B is selected">
                <input id="toggleAB" type="checkbox" />
                <span class="slider"></span>
              </label>
            </div>
            <div class="overlay-row">
              <span class="muted">Merged line view</span>
              <label class="switch">
                <input id="showMerged" type="checkbox" />
                <span class="slider"></span>
              </label>
            </div>
            <p class="muted small">
              Hollow boxes for clarity. When A and B are both on, we show a joint overlay.
            </p>
          </div>
        </section>

        <section class="section-panel">
          <div class="panel-title">
            <div class="label">GT status</div>
            <span id="gtStatusBadge" class="badge">-</span>
          </div>
          <div id="gtStatusNote" class="muted">Select a data point to review GT.</div>
          <div id="gtEmptyState" class="gt-empty minimal">
            <div class="muted">Keep dataset GT and mark this field reviewed.</div>
          </div>
          <div id="gtExcludedCount" class="muted">Excluded in this run: -</div>
        </section>

      </aside>

      <main class="viewer viewer-stack">
        <div class="viewer-top">
          <section class="section-panel browse-panel">
            <div class="browse-bar">
              <div class="browse-field browse-search collapsed" id="browseSearch">
                <div class="search-control">
                  <button id="toggleSearch" type="button">Search</button>
                  <input id="docSearch" type="text" placeholder="Search by doc id..." />
                </div>
              </div>
              <div class="browse-field">
                <select id="docSelect">
                  <option value="">Select a run first</option>
                </select>
              </div>
              <div class="browse-field">
                <select id="exampleSelect">
                  <option value="">Select a document first</option>
                </select>
              </div>
              <div class="browse-field browse-actions">
                <div class="btns">
                  <button id="prevSample">Previous</button>
                  <button id="nextSample">Next</button>
                </div>
              </div>
              <div class="browse-field browse-aux">
                <select id="evalRunSelect">
                  <option value="">Loading runs...</option>
                </select>
              </div>
            </div>
            <div class="run-meta">
              <span class="muted" id="evalRunName">-</span>
              <span class="muted" id="evalRunMeta">-</span>
              <span class="muted" id="docReviewCounts">-</span>
              <a class="link" href="/stats.html">Open stats</a>
            </div>
          </section>
        </div>
        <div class="viewer-panel">
          <div id="wv"></div>
        </div>
      </main>
    </div>
    <script src="/webviewer/webviewer.min.js"></script>
    <script src="./eval.js"></script>
  </body>
</html>
