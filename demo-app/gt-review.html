<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>GT Corrections</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="./gt-review.css" />
  </head>
  <body>
    <div class="wrap gt-wrap">
      <aside class="panel gt-panel">
        <div class="panel-header">
          <div class="kicker">Ground truth lab</div>
          <h1>GT Corrections</h1>
          <p class="muted">
            Review bad cases, draw corrected value boxes, and save to
            <span class="mono">data/gt_corrections/</span>.
          </p>
          <div class="cta-row">
            <a class="cta-link" href="/">Back to demo</a>
            <a class="cta-link" href="/stats.html">Eval stats</a>
          </div>
        </div>

        <div class="card step-card">
          <div class="step-header">
            <span class="step-num">1</span>
            <div>
              <div class="step-title">Choose a document</div>
              <div class="muted small">Pick the doc you want to review.</div>
            </div>
          </div>
          <div class="field">
            <label for="docSearch">Search docs</label>
            <input id="docSearch" type="text" placeholder="Filter by doc id..." />
          </div>
          <div class="field">
            <label for="docSelect">Document</label>
            <select id="docSelect" class="full"></select>
          </div>
          <div id="docMeta" class="muted small"></div>
        </div>

        <div class="card step-card">
          <div class="step-header">
            <span class="step-num">2</span>
            <div>
              <div class="step-title">Choose a prompt</div>
              <div class="muted small">Select the field label you want to verify.</div>
            </div>
          </div>
          <div class="field">
            <label for="promptSearch">Search prompts</label>
            <input id="promptSearch" type="text" placeholder="Filter by label or value..." />
          </div>
          <div id="promptList" class="prompt-list"></div>
          <button id="addCustom" class="ghost">Add custom correction</button>
        </div>

        <div class="card step-card">
          <div class="step-header">
            <span class="step-num">3</span>
            <div>
              <div class="step-title">Correct the value</div>
              <div class="muted small">Draw a box, edit the value, and save.</div>
            </div>
          </div>
          <div class="info-grid">
            <div class="info-label">Expected (GT)</div>
            <div id="expectedText" class="info-value">-</div>
            <div class="info-label">Raw answer</div>
            <div id="rawText" class="info-value">-</div>
            <div class="info-label">Indexed answer</div>
            <div id="indexedText" class="info-value">-</div>
          </div>
          <div class="toggle-row">
            <button id="toggleGt" class="ghost">Reveal GT boxes</button>
            <button id="toggleSaved" class="ghost active">Show saved boxes</button>
          </div>
          <div id="gtHint" class="muted small"></div>
          <div class="field">
            <label for="fieldLabel">Field label</label>
            <input id="fieldLabel" type="text" />
          </div>
          <div class="field">
            <label for="valueInput">Value</label>
            <input id="valueInput" type="text" placeholder="Type the correct value" />
          </div>
          <div class="field">
            <label for="valueType">Value type</label>
            <select id="valueType"></select>
          </div>
          <div class="field">
            <label for="notesInput">Notes</label>
            <textarea id="notesInput" rows="3" placeholder="Why GT is wrong, ambiguity, etc."></textarea>
          </div>
          <div class="field">
            <label for="bboxInput">BBox (x0, y0, x1, y1)</label>
            <div class="bbox-row">
              <input id="bboxInput" type="text" readonly />
              <button id="clearBox" class="ghost">Clear</button>
            </div>
          </div>
          <div class="quick-row">
            <button id="useExpected" class="ghost">Use expected</button>
            <button id="useRaw" class="ghost">Use raw</button>
            <button id="useIndexed" class="ghost">Use indexed</button>
          </div>
        </div>

        <div class="card">
          <div class="label">Actions</div>
          <button id="saveBtn" class="primary full">Save corrections</button>
          <div id="saveStatus" class="status small">Idle</div>
        </div>
      </aside>

      <main class="gt-viewer">
        <div class="viewer-toolbar">
          <div id="statusText" class="status">Loading...</div>
          <div class="legend">
            <span class="legend-item">
              <span class="swatch selected"></span>Selected
            </span>
            <span class="legend-item">
              <span class="swatch other"></span>Other saved boxes
            </span>
            <span class="legend-item">
              <span class="swatch gt"></span>GT boxes
            </span>
          </div>
        </div>
        <div class="viewer-stage">
          <div class="image-layer">
            <img id="docImage" alt="Document" />
            <canvas id="overlay"></canvas>
          </div>
        </div>
      </main>
    </div>

    <script src="./gt-review.js"></script>
  </body>
</html>
